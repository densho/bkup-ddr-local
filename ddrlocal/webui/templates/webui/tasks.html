{% extends "base.html" %}


{% block title %}Tasks{% endblock %}

{% block breadcrumbs %}{{ block.super }}
<li class="active">Tasks</li>
{% endblock breadcrumbs %}


{% block content %}

  <div class="row-fluid">
    <div class="span12">

<h1>Tasks</h1>

<table id="tasks" class="table">
<form name="task-dismiss" action="" method="post">{% csrf_token %}
  <input type='hidden' name='next' value='{{ form.next.value }}' />

{% for task in celery_tasks %}
  <tr>
    <td class="status {{ task.status }}">
{{ task.status }}
    </td>
    <td width="100">
{{ task.startd|timesince }} ago
    </td>
    <td>
{{ task.message|safe }}
<div id="{{ task.task_id }}" class="muted collapse">
  <table class="table table-condensed">
{% for key, value in task.items %}
    <tr>
      <th><small>{{ key }}</small></th>
      <td><small>{% if key == "traceback" %}<pre>{{ value }}</pre>{% else %}{{ value }}{% endif %}</small></td>
    </tr>
{% endfor %}
  </table>
</div>
    </td>
    <td>
<button type="button" class="btn btn-mini btn-link" data-toggle="collapse" data-target="#{{ task.task_id }}">
more&nbsp;info
</button>
    </td>
    <td>
{% if task.dismissable %}
<input id="id_dismiss_{{ task.task_id }}" name="dismiss_{{ task.task_id }}" type="checkbox" />
{% endif %}
    </td>
  </tr>
{% endfor %}

  <tr>
    <td colspan="4">
    </td>
    <td>
<button type="submit" class="btn btn-primary">Dismiss tasks</button>
    </td>
  </tr>

</form>
</table>

    </div><!-- .span12 -->
  </div><!-- .row-fluid -->

{% endblock content %}
